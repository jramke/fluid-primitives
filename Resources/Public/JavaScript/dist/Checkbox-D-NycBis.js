import{Component as e,Machine as t,mergeProps as n,normalizeProps as r}from"./Client-D6VJwEI0.js";import{getControlId as i,getFieldMachineFor as a,getLabelId as o}from"./field.dom-Bv_IpKYL.js";import*as s from"@zag-js/checkbox";const c=[`invalid`,`disabled`,`readOnly`,`required`];var l=class extends e{subscribedToField=!1;fieldMachine;closestField=null;getClosestField(){return this.closestField||this.getElement(`root`)?.closest(`[data-scope="field"][data-part="root"]`)||null}withFieldProps(e){if(this.closestField=this.getClosestField(),!this.closestField)return e;if(this.fieldMachine=a(this.closestField),this.fieldMachine)return this.propsWithField(e,this.fieldMachine);{let e=()=>{this.fieldMachine=a(this.closestField),this.updateProps(this.propsWithField(this.userProps,this.fieldMachine)),this.closestField?.removeEventListener(`fluid-primitives:field:registered`,e)};this.closestField.addEventListener(`fluid-primitives:field:registered`,e)}return e}subscribeToFieldService(){if(!this.subscribedToField)if(this.closestField=this.getClosestField(),this.fieldMachine)this.fieldMachine.subscribe(e=>{let t=c.map(t=>!!e.context.get(t)),n=c.map(e=>!!this.machine.prop(e)),r={};c.forEach((e,i)=>{t[i]!==n[i]&&(r[e]=t[i])}),Object.keys(r).length>0?this.updateProps(r):this.render()}),this.subscribedToField=!0;else{let e=()=>{this.subscribeToFieldService(),this.render(),this.closestField.removeEventListener(`fluid-primitives:field:registered`,e)};this.closestField.addEventListener(`fluid-primitives:field:registered`,e)}}},u=class extends l{static name=`checkbox`;propsWithField(e,t){return{...e,ids:{...e.ids,label:o(t.scope),hiddenInput:i(t.scope)}}}initMachine(e){return e=this.withFieldProps(e),new t(s.machine,e)}initApi(){return s.connect(this.machine.service,r)}render(){this.subscribeToFieldService();let e=this.getElement(`root`);e&&this.spreadProps(e,this.api.getRootProps());let t=this.getElement(`label`);t&&this.spreadProps(t,this.api.getLabelProps());let r=this.getElement(`control`);r&&this.spreadProps(r,this.api.getControlProps());let i=this.getElement(`indicator`);i&&this.spreadProps(i,this.api.getIndicatorProps());let a=this.getElement(`hidden-input`);if(a){let e=n(this.api.getHiddenInputProps(),{"aria-describedby":this.fieldMachine?.ctx.get(`describeIds`)||void 0});this.spreadProps(a,e)}}};export{u as Checkbox};